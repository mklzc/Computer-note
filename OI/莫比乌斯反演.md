# 莫比乌斯反演相关

## 数论函数和狄利克雷卷积

### 狄利克雷卷积

数论函数：值域为正整数（陪域为复数）的函数。

狄利克雷卷积是定义在数论函数之间的二元运算。

**性质 $1.1$**： 两个数论函数的狄利克雷卷积是一个新函数。

**定义**：

$f(n)$ 和 $g(n)$ 两个函数的狄利克雷卷积写作：

$\displaystyle (f\ast g)(n)=\sum_{d\mid n}f(d)g(\frac{n}{d})$，记为 $f\ast g$ 。

### 常见的数论函数

下面是几个简单的数论函数：

- 恒等函数：$I(x)=1$

- 元函数： $e(x)=[x=1]$

当 $n=1$ 时，函数值为 $1$，否则为 $0$。

被称作元函数是因为它是卷积的单位元：$e\ast g=g$。

- 欧拉函数：$\varphi(x)$ 模 `x` 域下的简化剩余系大小。

他们都是积性函数，其中 $I(x),e(x)$ 是完全积性函数。

#### 积性函数

- **完全积性函数** 定义：对于**任意**的整数 $a$ 和 $b$ 有$f(ab)=f(a)f(b)$

- **积性函数** 定义：一个函数 $F$ ，如果 $a,b$ 互质时有$F(ab)=F(a)F(b)$,则该函数是积性函数。

**性质 $1.2$**：对于积性函数 $F(x)$，可知 $F(x)=F(p_1^{c_1})\times F(p_2^{c_2})\times \dots \times F(p_k^{c_k})$ 。

其中 $x=p_1^{c_1}p_2^{c_2}\dots p_k^{c_k}$ 是 $x$ 在算术基本定理下的表达。

证明：由 $p_i^{c_i}$ 和 $p_j^{c_j}$ 两两互质互质易知。

应用：$F(p_i^{c_i})$ 处的函数值较 $F(x)$ 易于分析。

**性质 $1.3$**：两个积性函数的卷积仍然是积性函数。

证明：设积性函数 $f(x)$ 和 $g(x)$ ，$f\ast g = F$

对于函数 $F(n)=\sum_{d\mid n}{f(x)\times g(\frac{n}{d})}$

对于任意互质的 $a,b$ 有：

$F(a)\times F(b)=[\sum_{s\mid a}{f(s)\times g(\frac{a}{s})}]\times [\sum_{t\mid b}{f(t)\times g(\frac{b}{t})}]$

$\to \sum_{s\mid a}\sum_{t\mid b}{f(s)\times g(\frac{a}{s})\times f(t)\times g(t)}$

由积性函数的性质合并 $f(s)\times f(t)$ 和 $g(\frac{s}{t})\times g(\frac{b}{t})$

得到 $\sum_{st\mid ab}{f(st)\times g(\frac{ab}{st})}=F(a\times b)$。

**性质 $1.4$：** 积性函数在狄利克雷卷积下的逆也是积性函数。

函数在狄利克雷卷积下的逆定义为：满足 $g\ast f=e$（$e$ 为元函数）的函数 $g, f$ 互逆。
