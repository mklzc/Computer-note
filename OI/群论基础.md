# 群论

## 有限集的映射

（前置知识）

设两集合 $X={1, 2, 3\dots n}$ 和 $A={a_1, a_2\dots a_n}$。

$X$ 到 $A$ 的一个对应规则称为一个映射，记作：$\varphi=\begin{pmatrix}1&2&\dots&n\\a_1&a_2&\dots&a_n\end{pmatrix}$

$a_i=\varphi(1)$ 表示 $X$ 的对象 $i$ 对应 $A$ 的对象 $a_i$。

- 满映射：$\forall a\in A, \exists~i\in X,\text{ s.t. } a=\varphi(i)$，则映射 $\varphi$ 称为 `满映射` 或 `满射`。

- 单射：对于 $i,j\in X$ 如果有 $i\neq j$ 可推出 $\varphi(i)\neq \varphi(j)$，或者有 $\varphi(i)=\varphi(j)$ 可推出 $i=j$，则映射 $\varphi$ 称为 `一对一映射` 或 `单射`。

- 双射：如果映射 $\varphi$ 既是单射又是满射，则映射 $\varphi$ 称为双射。

满射，单射，双射的必要条件分别是 $|X|\ge |A|, |X|\le |A|$ 和 $|X|=|A|$。

## 群的基本概念

给定一个非空集合 $G$，和其上的二元运算 $*$，满足如下性质：

1. 封闭性：$\forall a,b\in G, a*b\in G$

2. 结合律：$\forall a,b,c\in G(a*b)*c=a*(b*c)$

3. 存在单位元：$\exists e\in G,\text{ s.t. }\forall a\in G$ 满足 $a*e=e*a=a$

4. 存在逆元：对于任意 $a\in G.\exists~b\in G,\text{ s.t. }a*b=b*a=e$（记 $b$ 为 $a^{-1}$）

就称 $G$ 对于 $*$ 运算成群，记为 $(G,*)$ 。

**例 $1.1$:** $G=R-\{0\}$ 对乘法 $\times$ 运算成群。

- 封闭性：实数乘以实数仍然在实数集合中。
- 结合律：乘法运算满足结合律。
- 存在单位元：单位元为 $1$。
- 存在逆元：$\forall a\in G$ ，有逆元 $\frac{1}{a}$

练 $1.1$: $G={0,1,2\dots n-1}$ 在 $\bmod~n$ 的加法下是群。

**性质 1.1** 群的单位元唯一。

证明：

反证法。假设有两个不同的单位元 $e_1,e_2$，由群的定义可知：

$e_1=e_1*e_2=e_2\to$ 矛盾。

**性质 1.2** 消去律：$a*c=b*c\to a=b$

**性质 1.3** 每个元素的逆唯一

反证法。假设 $a$ 有两个不同的逆元 $b, c$：

那么 $a*b=a=a*c$ 于是由 `性质1.2` 可知 $b=c$，矛盾。

**性质1.4** 任意一个元素的逆元的逆元是其本身。

设 $b$ 是 $a^{-1}$ 的逆元，则有 $b*a^{-1}=e=a^{-1}*a$，于是由 `性质1.2` 可知 $a=b$。

## 置换与置换群

### 置换的定义

集合 $X=\{1,2,3\dots n\}$ 到自身的双射。

$\begin{pmatrix}1&2&3&...&n\\a_1&a_2&a_3&...&a_n\end{pmatrix}$

简单来说，就是用 $a_i$ 取代 $i$。

其中各个 $a_i$ 互不相同，移动后 $n$ 个元素仍然存在，即 $a_1,a_2\dots a_n$ 为 $1\sim n$ 的一个排列。

如 $p=\begin{pmatrix}1&2&3&4\\3&1&4&2\end{pmatrix}$

这个置换就代表着:

- 把 $1$ 移到第 $3$ 个
- 把 $2$ 移到第 $1$ 个
- 把 $3$ 移到第 $4$ 个
- 把 $4$ 移到第 $2$ 个

写作 $1\xrightarrow{p}3~~~2\xrightarrow{p}1~~~3\xrightarrow{p}4~~~4\xrightarrow{p}2$。

### 置换的乘法

对于两个置换 $f=\begin{pmatrix}a_1,a_2,\dots,a_n\\a_{p_1},a_{p_2},\dots,a_{p_n}\end{pmatrix}$ 和 $g=\begin{pmatrix}a_{p_1},a_{p_2},\dots,a_{p_n}\\a_{q_1},a_{q_2},\dots,a_{q_n}\end{pmatrix}$。

相乘后值为 $\begin{pmatrix}a_1,a_2,\dots,a_n\\ a_{q_1},a_{q_2},\dots,a_{q_n}\end{pmatrix}$

简单来说就是先后经过 $f$ 的映射，再经过 $g$ 的映射。

看一个稍微复杂一点的例子：

设 $p_1=\begin{pmatrix}1&2&3&4\\2&3&1&4\end{pmatrix}$，$p_2=\begin{pmatrix}1&2&3&4\\2&4&1&3\end{pmatrix}$

则 $p_1*p_2=\begin{pmatrix}1&2&3&4\\4&1&2&3\end{pmatrix}$

因为 $1\xrightarrow{p_1}2\xrightarrow{p_2}4~\mid~2\xrightarrow{p_1}3\xrightarrow{p_2}1~\mid~3\xrightarrow{p_1}1\xrightarrow{p_2}2~\mid~4\xrightarrow{p}4\xrightarrow{p_2}3$。

**性质 2.1** 置换的乘法一般不满足交换律。

### 置换的轮换表示

对于一个置换 $\begin{pmatrix}1&2&3&...&n\\a_1&a_2&a_3&...&a_n\end{pmatrix}$ 将 $i\to a_i$ 用一条有向边连接。

$f$ 所决定的图的每个连通分支是一个轮换（又称循环置换），而这些不同的轮换形成 $X$ 的划分。

如 $f = \begin{pmatrix}1&2&3&4&5&6&7&8&9&10&11&12&13&14&15\\4&3&7&5&6&9&8&2&1&12&11&13&11&15&14\end{pmatrix}$。

于是 $f$ 可以表示为 $(1~4~5~6~9)(2~3~7~8)(10~12~13)(11)(14~15)$。

通常省略一元轮换，如 $(11)$，记 $f$ 为 $(1~4~5~6~9)(2~3~7~8)(10~12~13)(11)(14~15)$。

**性质 2.2** 轮换表示只与元素的相邻状况有关，而与哪个元素为首无关。

例如：$(1~2~3~4)=(2~3~4~1)$，但是 $(1~2~3~4)\neq(1~3~2~4)$

**性质 2.3** 任何置换都能表示成若干个不相交轮换的乘积形式，且表示方法唯一。

### 置换群

容易发现置换具有如下性质：

- 置换的乘积还是置换

- 具有单位元 $\begin{pmatrix}1&2&\dots&n\\1&2&\dots&n\end{pmatrix}$。

- 置换乘法满足结合律

- $\begin{pmatrix}1&2&3&...&n\\a_1&a_2&a_3&...&a_n\end{pmatrix}^{-1}=\begin{pmatrix}a_1&a_2&a_3&...&a_n\\1&2&3&...&n\end{pmatrix}$

根据以上性质，可以得到：**对 $1\sim n$ 作用的所有置换形成一个群**。

## Burnside / Polya 计数原理

设 $G$ 是 $\{1,2\dots n\}$ 的一个置换群。

### 概念

#### 不动点

对于 $p\in G$，若 $k\xrightarrow{p}k$，则称 $k$ 是 $p$ 下的不动点。

记 $p$ 的不动点个数为 $c(p)$。

#### k 不动置换类

对于 $p\in G$，若 $p$ 有不动点 $k$，则称 $p$ 属于 $k$ 不动置换类。

记作 $p\in Z_k$。

**例 $3.1$:**

设 $G={e, (1~2), (3~4), (1~2)(3~4)}$，那么

- $Z_1=\{e,(3~4)\}$
- $Z_2=\{e, (3~4)\}$
- $Z_3=\{e,(1~2)\}$
- $Z_4=\{e, (3~4)\}$

**性质 3.1** 单位元 $e$ 是所有 $k\in[1, n]$ 的不动点。

#### 等价类

**例 $3.2$:**

再看 $G={e, (1~2), (3~4), (1~2)(3~4)}$。

在群 $G$ 的作用下，数 $1$ 变成 $2$，$2$ 变成 $1$；$3$ 变成 $4$，$4$ 变成 $3$。

因此 $1, 2$ 属于同一类，而 $3, 4$ 属于另一类，$1$ 或 $2$ 不能在群的作用下变成 $3$ 或 $4$，$3$ 或 $4$ 也不能在群的作用下变成 $1$ 或 $2$。

于是可以得到 $k$ 所属的等价类可以看作 $k$ 在群的作用下的轨道。

等价类的本质还是集合。

**定理3.2(轨道稳定集子定理)**
$E_k*Z_k=|G|$。

证明：咕咕。

### Burnside 引理

**定理 3.3** 称 $E_{1\sim n}$ 中本质不同的个数为等价类个数，设为 $L$。

有：$\displaystyle L=\frac{1}{|G|}\sum_{p\in G}c(p)$

简单来说，就是 **等价类个数=各个置换中不动点个数的平均值**。

证明：咕咕。

**例 $3.3$:**

正方形均分为 $4$ 个格子，用两种颜色对 $4$ 个格子着色，问能得到多少中不同的图像。

解：

设逆时针旋转 $0^{\circ}, 90^{\circ}, 180^{\circ}, 270^{\circ}$ 为四种置换，将 $16$ 种染色方法看做元素。则 $G$ 是所有染色方法的一个置换群，即 $|G|=4$。

- 那么旋转 $0^{\circ}$ 为不动置换。即 $c(p_1)=16$，有 $16$ 个不动点。
- 旋转 $90^{\circ}$：手算一下有 $c(p_2)=2$。
- 旋转 $180^{\circ}$: 再手算一下有 $c(p_3)=4$。
- 旋转 $270^{\circ}$: 手算一下 $c(p_4)=2$。

于是本质不同的方案数为 $L=\frac{1}{|G|}\sum_{p\in G}{c(p)}=6$。

### Polya 原理

但是我们发现置换的大小过大后，很难用 $burnside$ 引理找出一个合理的计数方案。

于是有了 $Polya$ 原理（实质上就是 $Burnside$ 引理的推论）：

**定理 3.4** 用 $m$ 种颜色，涂染 $n$ 个对象，则不同的染色方案为：

$\displaystyle L=\frac{1}{|G|}\sum_{p\in G}{m^{d(p)}}$。其中 $d(p)$ 为置换 $p$ 的轮换个数。

#### 理解

**例 $3.4$:**

同例 $3.3$。正方形均分为 $4$ 个格子，用两种颜色对 $4$ 个格子着色，问能得到多少中不同的图像。

解：

$$
\begin{matrix}2&1\\3&4\\\end{matrix}
$$

将图形中四个格子标号为 $1,2,3,4$，如上所示。

将图形看作元素（注意，这与 $Burnside$ 引理中的定义不同），置换即为旋转置换（逆时针旋转 $0^{\circ}, 90^{\circ}, 180^{\circ}, 270^{\circ}$）。

于是可以得到 $G$ 中的 $4$ 种置换分别为：

- 旋转 $0^{\circ}$：$\begin{pmatrix}1&2&3&4\\1&2&3&4\\\end{pmatrix}=(1)~(2)~(3)~(4)$
- 旋转 $90^{\circ}$：$\begin{pmatrix}1&2&3&4\\4&1&2&3\\\end{pmatrix}=(4~3~2~1)$
- 旋转 $180^{\circ}$：$\begin{pmatrix}1&2&3&4\\3&4&1&2\\\end{pmatrix}=(1~3)~(2~4)$
- 旋转 $270^{\circ}$：$\begin{pmatrix}1&2&3&4\\2&3&4&1\\\end{pmatrix}=(1~2~3~4)$

由 $Polya$ 原理可以得到：$L=\frac{1}{2}\times (2^4+2^1+2^2+2^1)=6$

如此可见，$Polya$ 原理在某些计数问题上较 $Burnside$ 引理简洁。

#### 证明

证明从略。

首先设 $G$ 是对状态的置换群，有 $L=\frac{1}{|G|}\sum_{p\in G}{T(p)}$，其中 $T(p)$ 代表置换 $p$ 下不动的染色方案数。

比如 $\begin{pmatrix}1&2&3&4\\2&1&4&3\\\end{pmatrix}$，染成 $\{a,a,b,b\}$ 。

置换完了之后还是 $\{a,a,b,b\}$ ,则称之为不动的染色方案。

感性一点的理解就是把 `不动的染色方案` 看作 $Burnside$ 引理中的不动点，于是就可以得到以上形式。

（这也相当于 $Burnside$ 引理的一种变式吧，将 `不动的染色方案` 看作 $Burnside$ 引理中的不动点。）

在一个置换中显然一个轮换必须染上相同的颜色才能使得染色方案 `不动`，不同的轮换间互不影响，于是可以得出有 $m^{d(p)}$ 中染色方案。

综上即是 $Polya$ 原理：$\displaystyle L=\frac{1}{|G|}\sum_{p\in G}{m^{d(p)}}$。

## 练习

### [[模板]Pólya 定理](https://www.luogu.com.cn/problem/P4980)

将置换看作：旋转 $1,2\dots n$ 次，于是 $|G|=n$。

容易发现旋转 $i$ 次的置换的轮换有 $gcd(n,i)$ 个。

所以 $L=\frac{1}{n}\sum_{i = 1}^{n}{m^{gcd(n, i)}}$

### [魔力环](https://www.luogu.com.cn/problem/P4916)

[题解](https://www.luogu.com.cn/blog/command-block/solution-p4916)。
