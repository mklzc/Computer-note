# FFT, NTT

## FFT(傅里叶变换)

写的不怎么详细。

前置知识：**复数的基本运算**。

**多项式的点值表达**：给定 $n+1$ 个点即可确定唯一一个 n 次多项式 $F(x)$。

这里的点是指有序数对 $(x_i, F(x_i))$

**单位根**：$n$次单位根是 $n$ 次幂为 $1$ 的复数，$n\in \mathbb{N^*}$ 。

容易知道，只有模长为 $1$ 的复数才可能成为 $n$ 次单位根。

由于复数相乘，幅角相加，那么在复数单位圆中，$n$ 等分圆周的点均为 $n$ 次单位根（因为相乘过后均是圆周的整数倍）。

于是 $n$ 次单位根会有 $n$ 个，分别记为 $\omega_{n}^{1},\omega_{n}^{2}\dots \omega_{n}^{k}$ 。

$FFT$ 过程：

设有 $n-1$ 次多项式 $F(x)$，这里保证 $n$ 是 $2$ 的整数次幂。

$L(x)=(F[0]+F[2]x^2+F[4]x^4+\dots F[n-2]^{\frac{n}{2}-1})$

$R(x)=(F[1]+F[3]x+\dots +F[n-1]^{\frac{n}{2}-1})$

于是 $F(x)=L(x^2)+xR(x^2)$

1. 向其中代入 $\omega_{n}^{k}$：$F(\omega_{n}^{k})=L(\omega_{n/2}^{k})+\omega_{n}^{k}R(\omega_{n/2}^{k})$
2. 向其中带入 $\displaystyle \omega_{n}^{k+\frac{n}{2}}$：$F(\omega_{n}^{k+\frac{n}{2}})=L(\omega_{n/2}^{k})-R(\omega_{n/2}^{k})$

带入单位根后即可求的 $F(x)$ 的点值表达，上述过程就是 $DFT$ 的过程。

要将点值表达还原为一个多项式，就需要用到 $IDFT$。

$IDFT$ 的本质就是单位根反演，这里不做过多论述，实现时，只需要将求单位根 $\omega_{n}^{k}$ 变为求 $\omega_{n}^{-k}$ 即可。

代码：

---

$FFT$ 过程中会使用正余弦函数，进而引发精度问题。

$NTT$ 则找到了单位根的替代品：原根。

回顾单位根的性质：

1. $\omega_n^k=(w_n^1)^k$

2. $\omega_n^k=\omega_n^{k\bmod n}$

3. $\omega_{2n}^{2k}=\omega_n^k$

若设 $g_n=g^{\frac{p-1}{n}}$

- $$
